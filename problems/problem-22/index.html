<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Names Scores | Project Euler Solutions</title>
    <link
      rel="stylesheet"
      href="/euler-python/assets/css/style.css"
    />
    <!-- Favicon links -->
    <link
      rel="icon"
      type="image/png"
      href="/euler-python/assets/favicon/favicon.ico"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/euler-python/assets/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/euler-python/assets/favicon/favicon-16x16.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="48x48"
      href="/euler-python/assets/favicon/favicon-48x48.png"
    />
    <link
      rel="apple-touch-icon"
      href="/euler-python/assets/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/euler-python/assets/favicon/favicon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="/euler-python/assets/favicon/favicon-512x512.png"
    />
    <!-- End favicon links -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            ["$", "$"],
            ["\(", "\)"],
          ],
          displayMath: [
            ["$$", "$$"],
            ["\[", "\]"],
          ],
          processEscapes: true,
        },
        options: {
          ignoreHtmlClass: "no-mathjax",
          processHtmlClass: "mathjax",
        },
        startup: {
          pageReady: function () {
            return MathJax.startup.defaultPageReady().then(function () {
              // Force update math when the page loads
              MathJax.typeset();
            });
          },
        },
      };
    </script>
    <script
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>

    <!-- Pyodide for running Python in browser -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="site-title" href="/euler-python/"
          >Project Euler Solutions</a
        >
        <nav class="site-nav">
          <a href="/euler-python/">Home</a>
          <a href="/euler-python/euler-library/">Euler Library</a>
          <a href="https://github.com/GeoKim0209/euler-python" target="_blank" rel="noopener"
            >GitHub</a
          >
        </nav>
        <img
          class="site-logo"
          src="/euler-python/assets/favicon/favicon-192x192.png"
          alt="Logo"
        />
        <button
          id="dark-mode-toggle"
          aria-label="Toggle dark mode"
          style="margin-left: 20px; padding: 8px 12px"
        >
          üåì Toggle Dark Mode
        </button>
      </div>
    </header>

    <main class="page-content">
      <div class="container">
<div class="problem-page">
  <div class="problem-navigation">
    <a href="/euler-python/" class="home-link">‚Üê Home</a>
    <h1>Problem 22: Names Scores</h1>
    <div class="nav-buttons">
      
      <a
        href="/euler-python/problems/problem-21/"
        class="nav-button prev-button"
        >‚Üê Previous</a
      >
       
      <a
        href="/euler-python/problems/problem-23/"
        class="nav-button next-button"
        >Next ‚Üí</a
      >
      
    </div>
  </div>

  <div class="problem-statement">
    <h2>Problem Statement</h2>
    <div class="statement-content mathjax"><p>Using <a href="resources/documents/0022_names.txt">names.txt</a> (right click and 'Save Link/Target As...'), a 46K text file containing over five-thousand first names, begin by sorting it into alphabetical order. Then working out the alphabetical value for each name, multiply this value by its alphabetical position in the list to obtain a name score.</p>
<p>For example, when the list is sorted into alphabetical order, COLIN, which is worth $3 + 15 + 12 + 9 + 14 = 53$, is the $938$th name in the list. So, COLIN would obtain a score of $938 \times 53 = 49714$.</p>
<p>What is the total of all the name scores in the file?</p></div>
  </div>

  <div class="problem-solution">
    <h2>Solution</h2>
    <div class="code-container"><div class="highlight"><pre><span></span><span class="c1"># Names Scores</span>

<span class="sa">r</span><span class="sd">&quot;&quot;&quot;&lt;p&gt;Using &lt;a href=&quot;resources/documents/0022_names.txt&quot;&gt;names.txt&lt;/a&gt; (right click and &#39;Save Link/Target As...&#39;), a 46K text file containing over five-thousand first names, begin by sorting it into alphabetical order. Then working out the alphabetical value for each name, multiply this value by its alphabetical position in the list to obtain a name score.&lt;/p&gt;</span>
<span class="sd">&lt;p&gt;For example, when the list is sorted into alphabetical order, COLIN, which is worth $3 + 15 + 12 + 9 + 14 = 53$, is the $938$th name in the list. So, COLIN would obtain a score of $938 \times 53 = 49714$.&lt;/p&gt;</span>
<span class="sd">&lt;p&gt;What is the total of all the name scores in the file?&lt;/p&gt;&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">get_alphabet_score</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="o">-</span> <span class="mi">64</span>
    <span class="k">return</span> <span class="n">total</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;solutions/names.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">get_alphabet_score</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>

    <div class="code-execution">
      <button
        class="run-code-btn"
        data-code="def get_alphabet_score(name: str):
    total = 0
    for i in name:
        total += ord(i.upper()) - 64
    return total
with open(&#34;solutions/names.txt&#34;, &#34;r&#34;) as f:
    text = f.readlines()[0]
text = text.split(&#34;,&#34;)
print(len(text))
print(text[:100])
names = []
for i in text:
    i = i.replace(&#39;&#34;&#39;, &#34;&#34;)
    names.append(i)
names = sorted(names)
total = 0
for i, name in enumerate(names):
    total += (i + 1) * get_alphabet_score(name)
print(total)"
        data-output="output-22"
        onclick="runPythonCodeFromButton(this)"
        disabled
      >
        Loading Python...
      </button>
      <div id="output-22" class="code-output"></div>
    </div>
  </div>
</div>
</div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <p>
          &copy; 2025 Geo Kim. Built with Python
          for Project Euler Solutions.
        </p>
      </div>
    </footer>
    <script>
      const toggle = document.getElementById("dark-mode-toggle");
      const html = document.documentElement;

      // Apply saved mode on load
      if (localStorage.getItem("theme") === "dark") {
        html.classList.add("dark");
      }

      toggle.addEventListener("click", () => {
        html.classList.toggle("dark");
        const isDark = html.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
    </script>

    <script>
      // Pyodide Web Worker with timeout support
      let pyodideWorker = null;
      let pyodideReady = false;
      let requestCounter = 0;
      let pendingRequests = new Map();
      let isWorkerInitializing = false;

      // Default timeout in milliseconds (5 seconds)
      const DEFAULT_TIMEOUT = 5000;

      async function createWorker() {
        // Create and initialize the worker
        const worker = new Worker(
          "/euler-python/pyodide-worker.js"
        );

        // Set up worker message handling
        worker.addEventListener("message", handleWorkerMessage);

        // Initialize Pyodide in worker
        worker.postMessage({ type: "init" });

        return worker;
      }

      async function initPyodide() {
        if (pyodideReady || isWorkerInitializing) return;

        try {
          isWorkerInitializing = true;
          pyodideWorker = await createWorker();
        } catch (error) {
          console.error("Failed to initialize Pyodide worker:", error);
          isWorkerInitializing = false;

          // Fallback: show error on all buttons
          document.querySelectorAll(".run-code-btn").forEach((btn) => {
            btn.textContent = "Python unavailable";
            btn.disabled = true;
            btn.title = error.message;
          });
        }
      }

      async function recreateWorker() {
        console.log("Recreating Pyodide worker...");

        // Terminate old worker if it exists
        if (pyodideWorker) {
          pyodideWorker.terminate();
        }

        // Reset state
        pyodideReady = false;
        isWorkerInitializing = false;

        // Create new worker
        await initPyodide();

        // Wait for worker to be ready
        return new Promise((resolve) => {
          const checkReady = () => {
            if (pyodideReady) {
              resolve();
            } else {
              setTimeout(checkReady, 100);
            }
          };
          checkReady();
        });
      }

      function handleWorkerMessage(event) {
        const { type, requestId, result, error, isTimeout } = event.data;

        switch (type) {
          case "pyodide-ready":
            pyodideReady = true;
            isWorkerInitializing = false;
            console.log("Pyodide worker initialized successfully");

            // Enable all run buttons
            document.querySelectorAll(".run-code-btn").forEach((btn) => {
              btn.disabled = false;
              btn.textContent = "Run Code";
            });
            break;

          case "pyodide-error":
            console.error("Pyodide worker error:", error);
            isWorkerInitializing = false;
            document.querySelectorAll(".run-code-btn").forEach((btn) => {
              btn.textContent = "Failed to load Python";
              btn.disabled = true;
            });
            break;

          case "execution-success":
            if (pendingRequests.has(requestId)) {
              const { resolve, timeoutId } = pendingRequests.get(requestId);
              clearTimeout(timeoutId);
              pendingRequests.delete(requestId);
              resolve({ success: true, result });
            }
            break;

          case "execution-error":
            if (pendingRequests.has(requestId)) {
              const { reject, timeoutId } = pendingRequests.get(requestId);
              clearTimeout(timeoutId);
              pendingRequests.delete(requestId);
              reject({ success: false, error, isTimeout });
            }
            break;
        }
      }

      async function runPythonCodeWithTimeout(code, timeout = DEFAULT_TIMEOUT) {
        if (!pyodideReady) {
          throw new Error("Pyodide not ready");
        }

        const requestId = ++requestCounter;

        return new Promise((resolve, reject) => {
          // Set up timeout
          const timeoutId = setTimeout(async () => {
            if (pendingRequests.has(requestId)) {
              pendingRequests.delete(requestId);

              // Terminate the worker to stop execution
              console.log("Timeout reached, terminating worker");
              if (pyodideWorker) {
                pyodideWorker.terminate();
              }

              // Reject with timeout error
              reject({
                success: false,
                error: `Code execution timed out after ${
                  timeout / 1000
                } seconds`,
                isTimeout: true,
              });

              // Recreate worker for future use (don't await to avoid blocking)
              recreateWorker().catch(console.error);
            }
          }, timeout);

          // Store request info
          pendingRequests.set(requestId, { resolve, reject, timeoutId });

          // Send code to worker
          pyodideWorker.postMessage({
            type: "run-code",
            data: { code, requestId },
          });
        });
      }

      async function runPythonCode(code, outputElementId) {
        const outputElement = document.getElementById(outputElementId);
        const runButton = document.querySelector(
          `[data-output="${outputElementId}"]`
        );

        if (!pyodideReady) {
          outputElement.innerHTML =
            '<div class="output-loading">Initializing Python environment...</div>';
          runButton.disabled = true;
          runButton.textContent = "Loading...";
          await initPyodide();

          // Wait a bit for initialization
          await new Promise((resolve) => setTimeout(resolve, 1000));
        }

        try {
          runButton.disabled = true;
          runButton.textContent = "Running...";
          outputElement.innerHTML =
            '<div class="output-loading">Running code...</div>';

          const result = await runPythonCodeWithTimeout(code);

          if (result.result && result.result.trim()) {
            outputElement.innerHTML = `<div class="output-success"><strong>Output:</strong><pre>${result.result}</pre></div>`;
          } else {
            outputElement.innerHTML =
              '<div class="output-info">Code executed successfully (no output)</div>';
          }
        } catch (error) {
          if (error.isTimeout) {
            outputElement.innerHTML = `<div class="output-error"><strong>Timeout Error:</strong><pre>${error.error}</pre><div class="timeout-info">The code took too long to execute and was terminated to prevent browser hang.</div></div>`;
          } else {
            outputElement.innerHTML = `<div class="output-error"><strong>Error:</strong><pre>${
              error.error || error.message
            }</pre></div>`;
          }
        } finally {
          runButton.disabled = false;
          runButton.textContent = "Run Code";
        }
      }

      function runPythonCodeFromButton(button) {
        const code = button.getAttribute("data-code");
        const outputId = button.getAttribute("data-output");
        runPythonCode(code, outputId);
      }

      // Initialize Pyodide when the page loads (in background)
      document.addEventListener("DOMContentLoaded", () => {
        // Start loading Pyodide in the background
        initPyodide();
      });
    </script>
  </body>
</html>